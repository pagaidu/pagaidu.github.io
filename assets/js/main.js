const ANIMATION_DURATIONS={overlayEnter:.7,overlayLeave:.7,fadeIn:0.2,fadeOut:.7,};const ANIMATION_EASES={overlayEnter:'power1.in',overlayLeave:'power2.out',fadeIn:'power2.in',fadeOut:'sine.out'};function updateHead(newPageRawHTML){const head=document.head;const newPageRawHead=newPageRawHTML.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[1];const newPageHead=document.createElement('div');newPageHead.innerHTML=newPageRawHead;const selectors=["meta[name='description']","meta[property='og:description']"];selectors.forEach(selector=>{const existingTag=head.querySelector(selector);const newTag=newPageHead.querySelector(selector);if(existingTag&&newTag){existingTag.setAttribute('content',newTag.getAttribute('content'))}else if(newTag){head.appendChild(newTag.cloneNode(!0))}})}
function updateFooter(newPageRawHTML){const footer=document.querySelector('.footer');const newPageRawFooter=newPageRawHTML.match(/<footer[^>]*>([\s\S.]*)<\/footer>/i)[1];const newPageFooter=document.createElement('div');newPageFooter.innerHTML=newPageRawFooter;footer.innerHTML=newPageFooter.innerHTML}
function updateFooterClass(namespace){const footer=document.querySelector('.footer');if(footer){if(namespace==='home'){footer.classList.add('index')}else{footer.classList.remove('index')}}}
function setActiveLink(){const currentPath=window.location.pathname.replace(/\/$/,'');const footerLinks=Array.from(document.querySelectorAll('.footer-link'));if(document.activeElement){document.activeElement.blur()}
const classesToAdd=[];const classesToRemove=[];footerLinks.forEach(link=>{const linkPath=link.getAttribute('href').replace(/\/$/,'');if(linkPath===currentPath){classesToAdd.push(link)}else{classesToRemove.push(link)}});classesToRemove.forEach(link=>link.classList.remove('active'));classesToAdd.forEach(link=>link.classList.add('active'))}
function initializeVideo(){const video=document.getElementById('front__cover-video');video.load();video.addEventListener('canplay',()=>{video.play()})}
function initializeDropdown(){seamless.polyfill();const dropdownToggles=document.querySelectorAll('.dropdown-toggle.js-only');const dropdownWrappers=document.querySelectorAll('.dropdown-wrapper');dropdownToggles.forEach((dropdownToggle,index)=>{const dropdownWrapper=dropdownWrappers[index];dropdownToggle.addEventListener('click',function(event){event.stopPropagation();const expanded=this.getAttribute('aria-expanded')==='true';dropdownToggles.forEach((toggle,toggleIndex)=>{const wrapper=dropdownWrappers[toggleIndex];if(toggle!==dropdownToggle){toggle.setAttribute('aria-expanded','false');wrapper.classList.remove('open')}});const isNowExpanded=!expanded;this.setAttribute('aria-expanded',isNowExpanded);dropdownWrapper.classList.toggle('open',isNowExpanded);if(isNowExpanded){const offset=30;const rect=dropdownWrapper.getBoundingClientRect();const targetScrollPosition=window.scrollY+rect.top-offset;seamless.scrollTo(window,{top:targetScrollPosition,behavior:'smooth'})}})});document.addEventListener('click',function(){dropdownToggles.forEach((toggle,index)=>{const wrapper=dropdownWrappers[index];toggle.setAttribute('aria-expanded','false');wrapper.classList.remove('open')})})}
function closeDropdown(){const dropdownCheckbox=document.getElementById('dropdown-checkbox');const dropdownToggle=document.querySelector('.dropdown-toggle');if(dropdownCheckbox&&dropdownToggle){dropdownCheckbox.checked=!1;dropdownToggle.setAttribute('aria-expanded','false')}
const dropdownWrapper=document.querySelector('.dropdown-wrapper');if(dropdownWrapper){dropdownWrapper.classList.remove('open')}}
function overlayEnter(){return new Promise((resolve)=>{const overlay=document.createElement('div');overlay.classList.add('overlay');document.body.appendChild(overlay);gsap.fromTo(overlay,{x:'-100%'},{x:'0%',duration:ANIMATION_DURATIONS.overlayEnter,ease:ANIMATION_EASES.overlayEnter,onComplete:resolve,})})}
function overlayLeave(){return new Promise((resolve)=>{const overlay=document.querySelector('.overlay');if(!overlay){resolve();return}
gsap.to(overlay,{x:'100%',duration:ANIMATION_DURATIONS.overlayLeave,ease:ANIMATION_EASES.overlayLeave,onComplete:()=>{overlay.remove();resolve()},})})}
function gsapFade(element,fromOpacity,toOpacity,duration,ease,onComplete){if(!element){console.error('Element not found for gsapFade');return Promise.resolve()}
return new Promise(resolve=>{gsap.to(element,{opacity:toOpacity,duration:duration,ease:ease,onComplete:()=>{if(onComplete)onComplete();resolve()},onStart:()=>{element.style.opacity=fromOpacity.toString()}})})}
function resetScrollPosition(){window.scrollTo({top:0,behavior:'smooth'})}
document.addEventListener('DOMContentLoaded',()=>{const preloaderKey='preloaderShown';const isInitialVisit=!sessionStorage.getItem(preloaderKey);const loadingOverlay=document.querySelector('.loading-overlay');const loadingCircleBase=document.querySelector('.loading-circle');const loadingCircle=document.querySelector('.circle-progress');const loadingText=document.querySelector('.loading-text');const fallbackMessage=document.querySelector('.fallback-message');const disableOverlayLink=loadingOverlay.querySelector('.disable-overlay');let fallbackTimeout;const resetFallbackTimer=()=>{clearTimeout(fallbackTimeout);fallbackTimeout=setTimeout(()=>{if(progress<90)fallbackMessage.style.display='block'},10000)};resetFallbackTimer();disableOverlayLink.addEventListener('click',(event)=>{event.preventDefault();loadingOverlay.style.display='none'});let progress=0;const circumference=314;const updateProgress=()=>{const offset=(1-progress/100)*circumference;loadingCircle.style.strokeDashoffset=offset.toFixed(2)};const animateProgress=()=>{if(progress<100){const increment=progress<20?0.5:0.2;progress=Math.min(progress+increment,100);updateProgress();resetFallbackTimer();requestAnimationFrame(animateProgress)}};const runPreloaderAnimations=async()=>{await gsap.timeline().to([loadingText,loadingCircleBase,fallbackMessage],{opacity:0,duration:ANIMATION_DURATIONS.fadeOut,ease:ANIMATION_EASES.fadeOut,}).to(loadingOverlay,{x:'100%',duration:ANIMATION_DURATIONS.overlayLeave*1.5,ease:ANIMATION_EASES.overlayLeave,onComplete:()=>loadingOverlay.remove(),});const contentContainer=document.querySelector('.content-wrapper');if(contentContainer){await gsap.to(contentContainer,{opacity:1,duration:ANIMATION_DURATIONS.overlayLeave,ease:ANIMATION_EASES.fadeIn,delay:ANIMATION_DURATIONS.overlayLeave,})}};if(isInitialVisit){animateProgress();window.addEventListener('load',async()=>{progress=100;updateProgress();await runPreloaderAnimations();sessionStorage.setItem(preloaderKey,'true');const container=document.querySelector('[data-barba-namespace]');if(container.dataset.barbaNamespace==='home'){initializeVideo()}
if(container.dataset.barbaNamespace==='post'){initializeDropdown()}})}else{loadingOverlay.remove()}
document.addEventListener('visibilitychange',()=>{if(document.visibilityState==='visible'){if(window.location.pathname==='/'){const video=document.getElementById('front__cover-video');video.load();video.play()}}});if('scrollRestoration' in history){history.scrollRestoration='manual'}
barba.init({transitions:[{name:'post-fade',from:{namespace:['post']},to:{namespace:['post']},leave(data){closeDropdown();const currentContainer=data.current.container.querySelector('.content-wrapper');return gsapFade(currentContainer,1,0,ANIMATION_DURATIONS.fadeOut,ANIMATION_EASES.fadeOut,()=>{data.current.container.style.display='none'})},enter(data){const nextContainer=data.next.container.querySelector('.content-wrapper');nextContainer.style.display='block';nextContainer.style.opacity='0';return gsapFade(nextContainer,0,1,ANIMATION_DURATIONS.fadeIn,ANIMATION_EASES.fadeIn,initializeDropdown)},},{name:'home-to-any',from:{namespace:['home']},to:{namespace:['post','default']},leave(data){return overlayEnter().then(()=>{data.current.container.style.display='none'})},enter(data){initializeDropdown();const nextContainer=data.next.container.querySelector('.content-wrapper');nextContainer.style.opacity='0';nextContainer.style.display='block';const timeline=gsap.timeline();timeline.add(overlayLeave());timeline.to(nextContainer,{opacity:1,duration:ANIMATION_DURATIONS.overlayLeave,ease:ANIMATION_EASES.overlayLeave,});return timeline.finished},},{name:'any-to-home',from:{namespace:['post','default']},to:{namespace:['home']},leave(data){return overlayEnter().then(()=>{data.current.container.style.display='none'})},enter(data){const homeContainer=data.next.container;gsap.set(homeContainer,{opacity:0});return Promise.all([overlayLeave(),gsap.to(homeContainer,{opacity:1,duration:ANIMATION_DURATIONS.overlayLeave,ease:ANIMATION_EASES.overlayLeave,}),])},},{name:'post-to-default',from:{namespace:['post','default']},to:{namespace:['default']},leave(data){return overlayEnter().then(()=>{data.current.container.style.display='none'})},enter(data){const nextContainer=data.next.container.querySelector('.content-wrapper');nextContainer.style.opacity='0';nextContainer.style.display='block';const overlayLeavePromise=overlayLeave();const fadeInPromise=new Promise((resolve)=>{gsap.to(nextContainer,{opacity:1,duration:ANIMATION_DURATIONS.overlayLeave,ease:ANIMATION_EASES.overlayLeave,onComplete:resolve,})});return Promise.all([overlayLeavePromise,fadeInPromise])},},{name:'default-to-post',from:{namespace:['default']},to:{namespace:['post']},leave(data){return overlayEnter().then(()=>{data.current.container.style.display='none'})},enter(data){const nextContainer=data.next.container.querySelector('.content-wrapper');nextContainer.style.opacity='0';nextContainer.style.display='block';const overlayLeavePromise=overlayLeave();const fadeInPromise=new Promise((resolve)=>{gsap.to(nextContainer,{opacity:1,duration:ANIMATION_DURATIONS.overlayLeave*2,ease:ANIMATION_EASES.overlayLeave,onComplete:resolve,})});return Promise.all([overlayLeavePromise,fadeInPromise])},},],});barba.hooks.beforeLeave(()=>{});barba.hooks.leave(()=>{if(['post'].includes(data.next.namespace)){closeDropdown()}});barba.hooks.afterLeave(()=>{const homeContainer=document.querySelector('[data-barba-namespace="home"]');if(homeContainer){homeContainer.style.opacity='';homeContainer.style.display=''}});barba.hooks.beforeEnter((data)=>{updateHead(data.next.html);updateFooter(data.next.html);updateFooterClass(data.next.namespace);if(data.next.namespace==='home'){const video=document.getElementById('front__cover-video');video.load();video.play();video.loop=!0}});barba.hooks.enter(()=>{setTimeout(resetScrollPosition,50)});barba.hooks.afterEnter((data)=>{if(['post','default'].includes(data.next.namespace)){setActiveLink()}})})