const e=.7,t=.7,o=.2,n=.7,a="power1.in",s="power2.out",r="power2.in",i="sine.out";let c=!1;function d(e){const t=document.activeElement;if(t&&(["input","textarea"].includes(t.tagName.toLowerCase())||t.isContentEditable))return;const o=document.querySelector(".dropdown-toggle.js-only");o&&("i"!==e.key.toLowerCase()&&"m"!==e.key.toLowerCase()||(e.preventDefault(),o.click()),"Escape"===e.key&&"true"===o.getAttribute("aria-expanded")&&(e.preventDefault(),o.click()))}class l{constructor(e){this.swipeTarget=e.querySelector(".post"),this.swipeTarget&&(this.prevUrl=e.dataset.prevUrl,this.nextUrl=e.dataset.nextUrl,this.touchStartX=0,this.touchStartY=0,this.touchEndX=0,this.touchEndY=0,this.isSwiping=!1,this.boundHandleKeyDown=this.handleKeyDown.bind(this),this.boundHandleTouchStart=this.handleTouchStart.bind(this),this.boundHandleTouchMove=this.handleTouchMove.bind(this),this.boundHandleTouchEnd=this.handleTouchEnd.bind(this),this.addEventListeners())}addEventListeners(){document.addEventListener("keydown",this.boundHandleKeyDown),this.swipeTarget.addEventListener("touchstart",this.boundHandleTouchStart,{passive:!0}),this.swipeTarget.addEventListener("touchmove",this.boundHandleTouchMove,{passive:!0}),this.swipeTarget.addEventListener("touchend",this.boundHandleTouchEnd)}handleKeyDown(e){"ArrowLeft"===e.key&&this.prevUrl?barba.go(this.prevUrl):"ArrowRight"===e.key&&this.nextUrl&&barba.go(this.nextUrl)}handleTouchStart(e){this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY,this.isSwiping=!0}handleTouchMove(e){this.isSwiping&&(this.touchEndX=e.touches[0].clientX,this.touchEndY=e.touches[0].clientY)}handleTouchEnd(){if(!this.isSwiping)return;const e=this.touchEndX-this.touchStartX,t=this.touchEndY-this.touchStartY;Math.abs(e)>Math.abs(t)&&Math.abs(e)>50&&(e>0&&this.prevUrl?barba.go(this.prevUrl):e<0&&this.nextUrl&&barba.go(this.nextUrl)),this.isSwiping=!1,this.touchStartX=0,this.touchStartY=0,this.touchEndX=0,this.touchEndY=0}destroy(){document.removeEventListener("keydown",this.boundHandleKeyDown),this.swipeTarget&&(this.swipeTarget.removeEventListener("touchstart",this.boundHandleTouchStart),this.swipeTarget.removeEventListener("touchmove",this.boundHandleTouchMove),this.swipeTarget.removeEventListener("touchend",this.boundHandleTouchEnd))}}let u=null;class h{constructor(){this.video=document.querySelector(".front__cover-video"),this.hasPlayedOnce=!1,this.video&&(this.boundOnVisibilityChange=this.onVisibilityChange.bind(this),this.boundAttemptPlay=this.attemptPlay.bind(this),this.addEventListeners(),this.attemptPlay())}addEventListeners(){document.addEventListener("visibilitychange",this.boundOnVisibilityChange),this.video.addEventListener("canplay",this.boundAttemptPlay,{once:!0})}async attemptPlay(){if(this.video&&this.video.paused)try{await this.video.play()}catch(e){console.warn("Video autoplay was prevented by the browser:",e.message)}}ready(){return new Promise((e=>{this.video.readyState>=3?e():this.video.addEventListener("canplay",e,{once:!0}),this.video.load()}))}onVisibilityChange(){this.video&&("visible"===document.visibilityState?requestAnimationFrame((()=>{this.video.currentTime=0,this.video.load(),this.attemptPlay()})):this.video.pause())}destroy(){this.video&&(this.video.pause(),this.video.removeEventListener("canplay",this.boundAttemptPlay)),document.removeEventListener("visibilitychange",this.boundOnVisibilityChange)}}let p=null;function m(){p&&p.destroy(),p=new h}function y(){setTimeout((()=>{seamless.polyfill();const e=document.querySelector(".dropdown-toggle.js-only"),t=document.querySelector(".dropdown-wrapper");if(!e||!t)return;const o=e.cloneNode(!0);e.parentNode.replaceChild(o,e),o.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault();const o="true"===this.getAttribute("aria-expanded");if(this.setAttribute("aria-expanded",!o),t.classList.toggle("open",!o),!o){const e=30,o=t.getBoundingClientRect(),n=window.scrollY+o.top-e;seamless.scrollTo(window,{top:n,behavior:"smooth"})}})),c||(document.addEventListener("click",(function(e){const t=document.querySelector(".dropdown-wrapper"),o=document.querySelector(".dropdown-toggle.js-only");t&&o&&!t.contains(e.target)&&!o.contains(e.target)&&(t.classList.remove("open"),o.setAttribute("aria-expanded","false"))})),c=!0)}),100)}function v(){const e=document.querySelector(".dropdown-wrapper"),t=document.querySelector(".dropdown-toggle.js-only");e&&e.classList.remove("open"),t&&t.setAttribute("aria-expanded","false")}function b(){return new Promise((t=>{const o=document.createElement("div");o.classList.add("overlay"),document.body.appendChild(o),gsap.fromTo(o,{x:"-100%"},{x:"0%",duration:e,ease:a,onComplete:t})}))}function f(){return new Promise((e=>{const o=document.querySelector(".overlay");o?gsap.to(o,{x:"100%",duration:t,ease:s,onComplete:()=>{o.remove(),e()}}):e()}))}function g(e,t,o,n,a,s){return e?new Promise((r=>{gsap.to(e,{opacity:o,duration:n,ease:a,onComplete:()=>{s&&s(),r()},onStart:()=>{e.style.opacity=t.toString()}})})):(console.error("Element not found for gsapFade"),Promise.resolve())}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".fadein"),a=document.querySelector(".loading-overlay");if(a&&e){const E=a.querySelector(".loading-percentage"),L=a.querySelector(".progress-circle"),T=a.querySelector(".fallback-message"),x=a.querySelector(".enter-site-btn"),k=a.querySelector(".disable-overlay-btn"),q=a.querySelector(".loading-text"),C=a.querySelector(".progress-background"),P=L.r.baseVal.value,A=2*Math.PI*P;function c(e){const t=A-e/100*A;L.style.strokeDashoffset=t,E.textContent=`${Math.round(e)}%`}function h(){clearTimeout(Y);const e=gsap.timeline(),t=.3*(parseFloat(getComputedStyle(L).strokeWidth)||3);e.to(L,{strokeDashoffset:A,strokeWidth:t,opacity:0,duration:1.2,ease:"power2.inOut"}),e.to([E,C,q],{opacity:0,duration:.4,ease:"power1.in"},"<"),e.call((()=>{q.textContent="Gatavs lasīšanai!",x.style.display="block"})),e.fromTo([x,q],{opacity:0,y:20},{opacity:1,y:0,duration:.8,ease:"power2.out",stagger:.1},">-0.2")}function w(){const o=gsap.timeline();o.to([x,q],{opacity:0,duration:.25,ease:"power2.in",stagger:.1}),o.to(a,{x:"100%",duration:1.5*t,ease:s,onComplete:()=>a.remove()}),o.to(e,{opacity:1,visibility:"visible",duration:t,ease:"power1.inOut"},"<")}L.style.strokeDasharray=`${A} ${A}`,L.style.strokeDashoffset=A;const H=Array.from(document.images),M=document.querySelector(".front__cover-video"),D=H.length+(M?1:0);let U=0;function S(){U++;c(U/D*100),U===D&&setTimeout(h,250)}M&&new Promise((e=>{M.readyState>=3?e():(M.addEventListener("canplaythrough",e,{once:!0}),M.addEventListener("error",e,{once:!0}),M.load())})).then(S),0===D?(c(100),setTimeout(h,250)):H.forEach((e=>{e.complete&&0!==e.naturalHeight?S():(e.addEventListener("load",(()=>S()),{once:!0}),e.addEventListener("error",(()=>S()),{once:!0}))}));const Y=setTimeout((()=>{T.style.display="flex",gsap.to(T,{opacity:1,duration:.5})}),8e3);x.addEventListener("click",w),k.addEventListener("click",(()=>{clearTimeout(Y),w()}))}document.querySelector('[data-barba-namespace="home"]')&&m(),"scrollRestoration"in history&&(history.scrollRestoration="manual"),y(),barba.init({transitions:[{name:"post-fade",from:{namespace:["post"]},to:{namespace:["post"]},leave(e){v();return g(e.current.container.querySelector(".content-wrapper"),1,0,n,i,(()=>{e.current.container.style.display="none"}))},enter(e){const t=e.next.container.querySelector(".content-wrapper");return t.style.display="block",t.style.opacity="0",g(t,0,1,o,r).then((()=>{y()}))}},{name:"home-to-any",from:{namespace:["home"]},to:{namespace:["post","default"]},leave:e=>b().then((()=>{e.current.container.style.display="none"})),enter(e){y();const o=e.next.container.querySelector(".content-wrapper");o.style.opacity="0",o.style.display="block";const n=gsap.timeline();return n.add(f()),n.to(o,{opacity:1,duration:t,ease:s}),n.finished}},{name:"any-to-home",from:{namespace:["post","default"]},to:{namespace:["home"]},leave:e=>b().then((()=>{e.current.container.style.display="none"})),enter(e){const o=e.next.container;return gsap.set(o,{opacity:0}),m(),p.ready().then((()=>(p.attemptPlay(),Promise.all([f(),gsap.to(o,{opacity:1,duration:t,ease:s})]))))}},{name:"post-to-default",from:{namespace:["post","default"]},to:{namespace:["default"]},leave:e=>b().then((()=>{e.current.container.style.display="none"})),enter(e){const o=e.next.container.querySelector(".content-wrapper");o.style.opacity="0",o.style.display="block";const n=f(),a=new Promise((e=>{gsap.to(o,{opacity:1,duration:t,ease:s,onComplete:e})}));return Promise.all([n,a])}},{name:"default-to-post",from:{namespace:["default"]},to:{namespace:["post"]},leave:e=>b().then((()=>{e.current.container.style.display="none"})),enter(e){const o=e.next.container.querySelector(".content-wrapper");o.style.opacity="0",o.style.display="block";const n=f(),a=new Promise((e=>{gsap.to(o,{opacity:1,duration:2*t,ease:s,onComplete:e})}));return Promise.all([n,a])}}]}),barba.hooks.beforeLeave((()=>{})),barba.hooks.leave((e=>{e&&e.next&&["post"].includes(e.next.namespace)&&v()})),barba.hooks.afterLeave((e=>{const t=document.querySelector('[data-barba-namespace="home"]');t&&(t.style.opacity="",t.style.display=""),window.scrollTo({top:0,behavior:"auto"}),"home"===e.current.namespace&&p&&(p.destroy(),p=null),"post"===e.current.namespace&&u&&(u.destroy(),u=null),["post","default"].includes(e.current.namespace)&&document.removeEventListener("keydown",d)})),barba.hooks.beforeEnter((e=>{!function(e){const t=document.head,o=e.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[1],n=document.createElement("div");n.innerHTML=o,["meta[name='description']","meta[property='og:description']"].forEach((e=>{const o=t.querySelector(e),a=n.querySelector(e);o&&a?o.setAttribute("content",a.getAttribute("content")):a&&t.appendChild(a.cloneNode(!0))}))}(e.next.html),function(e){const t=document.querySelector(".footer"),o=e.match(/<footer[^>]*>([\s\S.]*)<\/footer>/i)[1],n=document.createElement("div");n.innerHTML=o,t.innerHTML=n.innerHTML}(e.next.html),function(e){const t=document.querySelector(".footer");t&&("home"===e?t.classList.add("index"):t.classList.remove("index"))}(e.next.namespace)})),barba.hooks.enter((()=>{})),barba.hooks.afterEnter((e=>{["post","default"].includes(e.next.namespace)&&(y(),function(){const e=window.location.pathname.replace(/\/$/,""),t=Array.from(document.querySelectorAll(".footer-link"));document.activeElement&&document.activeElement.blur();const o=[],n=[];t.forEach((t=>{t.getAttribute("href").replace(/\/$/,"")===e?o.push(t):n.push(t)})),n.forEach((e=>e.classList.remove("active"))),o.forEach((e=>e.classList.add("active")))}(),document.addEventListener("keydown",d)),"post"===e.next.namespace&&(u=new l(e.next.container)),"home"!==e.next.namespace||p||m()}))}));